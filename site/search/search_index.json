{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to My Devkit","title":"Home"},{"location":"backup-with-google-drive/","text":"C\u00e0i \u0111\u1eb7t Gdrive tr\u00ean Centos \u0110\u1ed1i v\u1edbi centos 64bit s\u1ebd ch\u1ea1y file gdrive-linux-x64, \u0111\u1ed1i v\u1edbi 32bit ch\u1ea1y file gdrive-linux-386 File 64bit File 32bit yum install wget wget -O drive http://document.dotb.vn/files/gdrive-linux-x64 mv drive /usr/sbin/drive chmod 755 /usr/sbin/drive X\u00e1c th\u1ef1c t\u00e0i kho\u1ea3n Google Drive drive about Go to the following link in your browser: https://accounts.google.com/o/oauth2/auth?client_id=123456789123-7n0vf5akeru7on6o2fjinrecpdoe99eg.apps.googleusercontent.com&redirect_uri=urn%3Aietf%3Awg%3Aoauth%3A2.0%3Aoob&response_type=code&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive&state=state Enter verification code: 4/9gKYAFAJ326XIP6JJHAEhs342t35LPiA5QGW0935GHWHy9 T\u1ea1o file sh \u0111\u1ec3 execute #!/bin/bash #th\u01b0 m\u1ee5c l\u01b0u file backup, KH\u00d4NG ch\u1ee9a d\u1ea5u / \u1edf cu\u1ed1i BACKUPDIR='/home/backup' #th\u00f4ng tin n\u01a1i ch\u1ee9a source c\u1ea7n backup SOURCENAME='dotb_tomato_crm' SOURCEDIR='/opt/lampp/htdocs/crm.tomato.edu.vn' #t\u00e0i kho\u1ea3n truy c\u1eadp database DBUSER='root' DBPASSWORD='hD41B*7l9e^S' DBNAME='online_crm_tomato' #path to mysqldump execute PATHMYSQLDUMP='/opt/lampp/bin/mysqldump' #s\u1ed1 ng\u00e0y l\u01b0u backup DATESUB=7 #folder google drive id FOLDER_GDRIVE='1qFMC-bO3FqbNCpS0nlQLx3dHoMtvn9Qz' #script x\u1eed l\u00fd #DO NOT EDIT DATENOW=`date +%Y-%m-%d` DATEDEL=$(date --date=\"${DATENOW} -${DATESUB} day\" +%Y_%m_%d) rm -f $BACKUPDIR/`echo $DATEDEL`_$SOURCENAME.zip DBOUT=\"$BACKUPDIR/$DBNAME.sql\" `echo $PATHMYSQLDUMP` --force --opt -u $DBUSER --password=$DBPASSWORD $DBNAME > $DBOUT zip -r $BACKUPDIR/$SOURCENAME.zip $SOURCEDIR zip $BACKUPDIR/`date +%Y_%m_%d`_$SOURCENAME.zip $DBOUT $BACKUPDIR/$SOURCENAME.zip rm -f $DBOUT rm -f $BACKUPDIR/$SOURCENAME.zip drive upload -p $FOLDER_GDRIVE $BACKUPDIR/`date +%Y_%m_%d`_$SOURCENAME.zip C\u00e0i \u0111\u1eb7t cronjob crontab -e #b\u1ea5m i \u0111\u1ec3 v\u00e0o ch\u1ebft \u0111\u1ed9 insert #ch\u00e8n d\u00f2ng th\u1ef1c thi backup h\u1eb1ng ng\u00e0y v\u00e0o 0h 0 0 * * * path_to_file_bash_backup","title":"Auto backup source to Google Drive"},{"location":"backup-with-google-drive/#cai-at-gdrive-tren-centos","text":"\u0110\u1ed1i v\u1edbi centos 64bit s\u1ebd ch\u1ea1y file gdrive-linux-x64, \u0111\u1ed1i v\u1edbi 32bit ch\u1ea1y file gdrive-linux-386 File 64bit File 32bit yum install wget wget -O drive http://document.dotb.vn/files/gdrive-linux-x64 mv drive /usr/sbin/drive chmod 755 /usr/sbin/drive","title":"C\u00e0i \u0111\u1eb7t Gdrive tr\u00ean Centos"},{"location":"backup-with-google-drive/#xac-thuc-tai-khoan-google-drive","text":"drive about Go to the following link in your browser: https://accounts.google.com/o/oauth2/auth?client_id=123456789123-7n0vf5akeru7on6o2fjinrecpdoe99eg.apps.googleusercontent.com&redirect_uri=urn%3Aietf%3Awg%3Aoauth%3A2.0%3Aoob&response_type=code&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive&state=state Enter verification code: 4/9gKYAFAJ326XIP6JJHAEhs342t35LPiA5QGW0935GHWHy9","title":"X\u00e1c th\u1ef1c t\u00e0i kho\u1ea3n Google Drive"},{"location":"backup-with-google-drive/#tao-file-sh-e-execute","text":"#!/bin/bash #th\u01b0 m\u1ee5c l\u01b0u file backup, KH\u00d4NG ch\u1ee9a d\u1ea5u / \u1edf cu\u1ed1i BACKUPDIR='/home/backup' #th\u00f4ng tin n\u01a1i ch\u1ee9a source c\u1ea7n backup SOURCENAME='dotb_tomato_crm' SOURCEDIR='/opt/lampp/htdocs/crm.tomato.edu.vn' #t\u00e0i kho\u1ea3n truy c\u1eadp database DBUSER='root' DBPASSWORD='hD41B*7l9e^S' DBNAME='online_crm_tomato' #path to mysqldump execute PATHMYSQLDUMP='/opt/lampp/bin/mysqldump' #s\u1ed1 ng\u00e0y l\u01b0u backup DATESUB=7 #folder google drive id FOLDER_GDRIVE='1qFMC-bO3FqbNCpS0nlQLx3dHoMtvn9Qz' #script x\u1eed l\u00fd #DO NOT EDIT DATENOW=`date +%Y-%m-%d` DATEDEL=$(date --date=\"${DATENOW} -${DATESUB} day\" +%Y_%m_%d) rm -f $BACKUPDIR/`echo $DATEDEL`_$SOURCENAME.zip DBOUT=\"$BACKUPDIR/$DBNAME.sql\" `echo $PATHMYSQLDUMP` --force --opt -u $DBUSER --password=$DBPASSWORD $DBNAME > $DBOUT zip -r $BACKUPDIR/$SOURCENAME.zip $SOURCEDIR zip $BACKUPDIR/`date +%Y_%m_%d`_$SOURCENAME.zip $DBOUT $BACKUPDIR/$SOURCENAME.zip rm -f $DBOUT rm -f $BACKUPDIR/$SOURCENAME.zip drive upload -p $FOLDER_GDRIVE $BACKUPDIR/`date +%Y_%m_%d`_$SOURCENAME.zip","title":"T\u1ea1o file sh \u0111\u1ec3 execute"},{"location":"backup-with-google-drive/#cai-at-cronjob","text":"crontab -e #b\u1ea5m i \u0111\u1ec3 v\u00e0o ch\u1ebft \u0111\u1ed9 insert #ch\u00e8n d\u00f2ng th\u1ef1c thi backup h\u1eb1ng ng\u00e0y v\u00e0o 0h 0 0 * * * path_to_file_bash_backup","title":"C\u00e0i \u0111\u1eb7t cronjob"},{"location":"install-server-lampp/","text":"Install LAMPP yum update yum -y install install curl net-tools curl -o xampp-linux-installer.run \"https://downloadsapachefriends.global.ssl.fastly.net/xampp-files/7.1.29/xampp-linux-x64-7.1.29-0-installer.run?from_af=true\" sudo chmod +x xampp-linux-installer.run bash -c './xampp-linux-installer.run' Khi g\u1eb7p l\u1ed7i ti\u1ebfn tr\u00ecnh c\u00e0i \u0111\u1eb7t b\u1ecb killed n\u1eefa ch\u1eebng th\u00ec c\u00f3 th\u1ec3 l\u1ed7i l\u00e0 do ph\u00e2n v\u00f9ng swap kh\u00f4ng \u0111\u1ee7, th\u1ef1c hi\u1ec7n l\u1eb9nh sau \u0111\u1ec3 kh\u1eafc ph\u1ee5c. (copy tr\u00ean internet ch\u1ee9 ch\u01b0a tham kh\u1ea3o th\u00f4ng s\u1ed1 c\u1ee7a n\u00f3 ngh\u0129a l\u00e0 g\u00ec) sudo dd if=/dev/zero of=swapfile bs=1024 count=2000000 sudo mkswap -f swapfile sudo swapon swapfile M\u1edf port 80,443,3306 sudo iptables -I INPUT -p tcp -m tcp --dport 80 -j ACCEPT sudo iptables -I INPUT -p tcp -m tcp --dport 443 -j ACCEPT sudo iptables -I INPUT -p tcp -m tcp --dport 3306 -j ACCEPT Thay \u0111\u1ed5i user v\u00e0 group cho user ch\u1ea1y lampp m\u1edf file /opt/lampp/etc/httpd.conf t\u00ecm d\u00f2ng sau v\u00e0 s\u1eeda l\u1ea1i th\u00e0nh user c\u1ee7a server n\u1ebfu c\u1ea7n thi\u1ebft User daemon Group daemon Public phpmyadmin S\u1eeda n\u1ed9i dung file /opt/lampp/etc/extra/httpd-xampp.conf, thay \u0111\u1ed5i require t\u1eeb local sang all granted n\u1ed9i dung ban \u0111\u1ea7u <Directory \"/opt/lampp/phpmyadmin\"> AllowOverride AuthConfig Limit Require local ErrorDocument 403 /error/XAMPP_FORBIDDEN.html.var </Directory> s\u1eeda th\u00e0nh <Directory \"/opt/lampp/phpmyadmin\"> AllowOverride AuthConfig Limit Require all granted ErrorDocument 403 /error/XAMPP_FORBIDDEN.html.var </Directory> S\u1eeda \u0111\u1ed5i file host /etc/hosts \u0110\u1ec3 cho ph\u00e9p truy c\u1eadp t\u1eeb ngo\u00e0i v\u00e0o server ch\u1ea1y xampp th\u00ec \u0111\u1ea7u ti\u00ean l\u00e0 c\u1ea7n tr\u1ecf t\u00ean mi\u1ec1n v\u1ec1 IP public c\u1ee7a server, \u0111\u1ebfn \u0111\u00e2y, server \u0111\u00e3 c\u00f3 th\u1ec3 truy c\u1eadp t\u1eeb b\u00ean ngo\u00e0i v\u00e0o r\u1ed3i. Vi\u1ec7c s\u1eeda \u0111\u1ed5i file hosts l\u00e0 1 trong c\u00e1c vi\u1ec7c ph\u1ea3i l\u00e0m n\u1ebfu mu\u1ed1n server ch\u1ea1y nhi\u1ec1u domain, c\u00f3 th\u1ec3 tham kh\u1ea3o b\u00e0i vi\u1ebft h\u01b0\u1edbng d\u1eabn t\u1ea1o domain cho server ch\u1ea1y xampp. 127.0.0.1 localhost 127.0.0.1 khanhtoan.name.vn Config login cho phpmyadmin Thay \u0111\u1ed5i auth_type th\u00e0nh http trong file /opt/lampp/phpmyadmin/config.inc.php v\u00e0 comment 2 d\u00f2ng config username v\u00e0 password l\u1ea1i. $cfg['Servers'][$i]['auth_type'] = 'http'; Thay \u0111\u1ed5i m\u1eadt kh\u1ea9u root mysql mysql -u root -p USE mysql; UPDATE user SET password=PASSWORD('YourPasswordHere') WHERE User='root' AND Host = 'localhost'; FLUSH PRIVILEGES; \u0110\u1ed1i v\u1edbi LAMPP th\u00ec mysql n\u1eb1m \u1edf \u0111\u01b0\u1eddng d\u1eabn /opt/lampp/bin/mysql, do \u0111\u00f3 cmd s\u1ebd l\u00e0: /opt/lampp/bin/mysql -u=\"root\" Th\u00eam vhosts v\u00e0 apache S\u1eeda file b\u1eb1ng c\u00f4ng c\u1ee5 vim, ch\u1ea1y l\u1ec7nh sau v\u00e0 \u1ea5n phim i \u0111\u1ec3 s\u1eeda, s\u1eeda xong b\u1ea5m ph\u00edm esc v\u00e0 g\u00f5 :wq sau \u0111\u00f3 enter \u0111\u1ec3 l\u01b0u file l\u1ea1i. vi /opt/lampp/etc/httpd.conf Th\u00eam v\u00e0o cu\u1ed1i file t\u00ean d\u00f2ng l\u1ec7nh sau: Include \"/opt/lampp/etc/extra/httpd-vhosts.conf\" C\u1ea5u h\u00ecnh vhost M\u1edf file /opt/lampp/etc/extra/httpd-vhost.conf v\u00e0 add th\u00eam domain v\u00e0o, v\u00ed d\u1ee5 th\u00eam domain mautic.dotb.vn, c\u00f3 th\u01b0 m\u1ee5c root ch\u01b0a source l\u00e0 /opt/lampp/htdocs/mautic.dotb.vn <VirtualHost 127.0.0.1:80> DocumentRoot \"/opt/lampp/htdocs/mautic.dotb.vn\" ServerName mautic.dotb.vn ServerAlias www.mautic.dotb.vn </VirtualHost> Sau t\u1ea5t c\u1ea3 c\u00e1c c\u1ea5u h\u00ecnh, ti\u1ebfn h\u00e0nh restart l\u1ea1i lampp /opt/lampp/lampp restart Script #!/bin/bash #user if [ $(id -u) -eq 0 ]; then read -p \"Enter host Domain: \" domainname read -p \"Enter new Domain username: \" tusername egrep \"^$tusername\" /etc/passwd >/dev/null if [ $? -eq 0 ]; then echo \"$tusername exists!\" exit 1 else useradd $tusername passwd $tusername read -p \"Enter new password again (latest): \" tpassword fi else echo \"Only root may add a user to the system\" exit 2 fi read -p \"Enter new MySQL root password : \" spassword mkdir \"/home/$tusername/$domainname\" echo \"success! $domainname - $tusername\" >>/home/$tusername/$domainname/index.php chown -R $tusername:$tusername /home/$tusername echo \"127.0.0.1 $domainname\" >>/etc/hosts yum -y update #java yum -y install java-1.8.0-openjdk.x86_64 #lampp yum -y install curl net-tools curl -o lampp.run \"https://downloadsapachefriends.global.ssl.fastly.net/xampp-files/7.1.29/xampp-linux-x64-7.1.29-0-installer.run?from_af=true\" chmod +x lampp.run bash -c './lampp.run' ln -sf /opt/lampp/lampp /usr/bin/lampp ln -sf /opt/lampp/bin/mysql /usr/bin/mysql ln -sf /opt/lampp/bin/php /usr/bin/php lampp restart lampp stopftp #httpd and php sed -i.bak s'/Require local/Require all granted/g' /opt/lampp/etc/extra/httpd-xampp.conf sed -i \"s/'config'/'http'/g\" /opt/lampp/phpmyadmin/config.inc.php echo 'Include \"/opt/lampp/etc/extra/httpd-vhosts.conf\"' >>/opt/lampp/etc/httpd.conf sed -i \"s/User daemon/User $tusername/g\" /opt/lampp/etc/httpd.conf sed -i \"s/Group daemon/Group $tusername/g\" /opt/lampp/etc/httpd.conf sed -i \"s/\\/opt\\/lampp\\/htdocs/\\/home/g\" /opt/lampp/etc/httpd.conf sed -i \"s/webmaster@dummy-host.example.com/contact@dotb.vn/g\" /opt/lampp/etc/extra/httpd-vhosts.conf sed -i \"s/\\/opt\\/lampp\\/docs\\/dummy-host.example.com/\\/home\\/$tusername\\/$domainname/g\" /opt/lampp/etc/extra/httpd-vhosts.conf sed -i \"s/dummy-host.example.com/$domainname/g\" /opt/lampp/etc/extra/httpd-vhosts.conf rm -f /opt/lampp/etc/php.ini echo '[PHP] engine=On short_open_tag=Off short_open_tag=On asp_tags=Off precision=14 y2k_compliance=On output_buffering=4096 zlib.output_compression=Off implicit_flush=Off unserialize_callback_func= serialize_precision=100 allow_call_time_pass_reference=Off safe_mode=Off safe_mode_gid=Off safe_mode_include_dir= safe_mode_exec_dir= safe_mode_allowed_env_vars=PHP_ safe_mode_protected_env_vars=LD_LIBRARY_PATH disable_functions= disable_classes= expose_php=On max_execution_time=3600 max_input_time=3600 memory_limit=2048M error_reporting=E_ALL & ~E_DEPRECATED & ~E_STRICT display_errors=Off display_startup_errors=On log_errors=On log_errors_max_len=1024 ignore_repeated_errors=Off ignore_repeated_source=Off report_memleaks=On track_errors=On html_errors=On error_log=\"/opt/lampp/logs/php_error_log\" variables_order=\"GPCS\" request_order=\"GP\" register_globals=Off register_long_arrays=Off register_argc_argv=Off auto_globals_jit=On post_max_size=1280M magic_quotes_gpc=Off magic_quotes_runtime=Off magic_quotes_sybase=Off auto_prepend_file= auto_append_file= default_mimetype=\"text/html\" doc_root= user_dir= enable_dl=Off file_uploads=On upload_tmp_dir=\"/opt/lampp/temp/\" upload_max_filesize=1280M allow_url_fopen=On allow_url_include=Off default_socket_timeout=60 [Date] date.timezone=Asia/Ho_Chi_Minh [filter] [iconv] [intl] [sqlite] [sqlite3] [Pcre] [Pdo] [Pdo_mysql] pdo_mysql.cache_size=2000 pdo_mysql.default_socket= [Phar] [Syslog] define_syslog_variables=Off [mail function] SMTP=localhost smtp_port=25 mail.add_x_header=On [SQL] sql.safe_mode=Off [ODBC] odbc.allow_persistent=On odbc.check_persistent=On odbc.max_persistent=-1 odbc.max_links=-1 odbc.defaultlrl=4096 odbc.defaultbinmode=1 [Interbase] ibase.allow_persistent=1 ibase.max_persistent=-1 ibase.max_links=-1 ibase.timestampformat=\"%Y-%m-%d %H:%M:%S\" ibase.dateformat=\"%Y-%m-%d\" ibase.timeformat=\"%H:%M:%S\" [MySQL] mysql.allow_local_infile=On mysql.allow_persistent=On mysql.cache_size=2000 mysql.max_persistent=-1 mysql.max_links=-1 mysql.default_port= mysql.default_socket= mysql.default_host= mysql.default_user= mysql.default_password= mysql.connect_timeout=60 mysql.trace_mode=Off [MySQLi] mysqli.max_persistent=-1 mysqli.max_links=-1 mysqli.cache_size=2000 mysqli.default_port=3306 mysqli.default_socket= mysqli.default_host= mysqli.default_user= mysqli.default_pw= mysqli.reconnect=Off [mysqlnd] mysqlnd.collect_statistics=On mysqlnd.collect_memory_statistics=On [OCI8] [PostgresSQL] pgsql.allow_persistent=On pgsql.auto_reset_persistent=Off pgsql.max_persistent=-1 pgsql.max_links=-1 pgsql.ignore_notice=0 pgsql.log_notice=0 [Sybase-CT] sybct.allow_persistent=On sybct.max_persistent=-1 sybct.max_links=-1 sybct.min_server_severity=10 sybct.min_client_severity=10 [bcmath] bcmath.scale=0 [browscap] [Session] session.save_handler=files session.save_path=\"/opt/lampp/temp/\" session.use_cookies=1 session.use_only_cookies=1 session.name=PHPSESSID session.auto_start=0 session.cookie_lifetime=0 session.cookie_path=/ session.cookie_domain= session.cookie_httponly=1 session.serialize_handler=php session.gc_probability=1 session.gc_divisor=1000 session.gc_maxlifetime=1440 session.bug_compat_42=On session.bug_compat_warn=On session.referer_check= session.entropy_length=0 session.entropy_file= session.cache_limiter=nocache session.cache_expire=180 session.use_trans_sid=1 session.hash_function=0 session.hash_bits_per_character=5 url_rewriter.tags=\"a=href,area=href,frame=src,input=src,form=fakeentry\" [MSSQL] mssql.allow_persistent=On mssql.max_persistent=-1 mssql.max_links=-1 mssql.min_error_severity=10 mssql.min_message_severity=10 mssql.compatability_mode=Off mssql.secure_connection=Off [Assertion] [COM] [mbstring] [gd] [exif] [Tidy] tidy.clean_output=Off [soap] soap.wsdl_cache_enabled=1 soap.wsdl_cache_dir=\"/tmp\" soap.wsdl_cache_ttl=86400 soap.wsdl_cache_limit=5 [sysvshm] [ldap] ldap.max_links=-1 [mcrypt] [dba] openssl.cafile=/opt/lampp/share/curl/curl-ca-bundle.crt ' >>/opt/lampp/etc/php.ini #mysql echo \" use mysql; UPDATE user SET password=PASSWORD('$spassword') WHERE User='root'; FLUSH PRIVILEGES; GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY '$spassword'; FLUSH PRIVILEGES; \" >>/change_password_mysql.sql echo \">>press Enter to pass ask below<<\" mysql -u root -p mysql </change_password_mysql.sql rm -f /change_password_mysql.sql rm -f /opt/lampp/etc/my.cnf echo ' [client] port = 3306 socket = /opt/lampp/var/mysql/mysql.sock [mysqld] user = mysql port=3306 socket = /opt/lampp/var/mysql/mysql.sock skip-external-locking key_buffer = 160M max_allowed_packet = 10M table_open_cache = 64 sort_buffer_size = 5M net_buffer_length = 80K read_buffer_size = 2M read_rnd_buffer_size = 5M myisam_sort_buffer_size = 80M plugin_dir = /opt/lampp/lib/mysql/plugin/ server-id = 1 innodb_data_home_dir = /opt/lampp/var/mysql/ innodb_data_file_path = ibdata1:10M:autoextend innodb_log_group_home_dir = /opt/lampp/var/mysql/ innodb_buffer_pool_size = 160M innodb_log_file_size = 50M innodb_log_buffer_size = 80M innodb_flush_log_at_trx_commit = 1 innodb_lock_wait_timeout = 50 [mysqldump] quick max_allowed_packet = 160M [mysql] no-auto-rehash [isamchk] key_buffer = 200M sort_buffer_size = 200M read_buffer = 20M write_buffer = 20M [myisamchk] key_buffer = 200M sort_buffer_size = 200M read_buffer = 20M write_buffer = 20M [mysqlhotcopy] interactive-timeout !include /opt/lampp/mysql/my.cnf ' >>/opt/lampp/etc/my.cnf #elasticsearch rpm --import https://artifacts.elastic.co/GPG-KEY-elasticsearch echo \"[elasticsearch-6.x]\" >>/etc/yum.repos.d/elasticsearch.repo echo \"name=Elasticsearch repository for 6.x packages\" >>/etc/yum.repos.d/elasticsearch.repo echo \"baseurl=https://artifacts.elastic.co/packages/6.x/yum\" >>/etc/yum.repos.d/elasticsearch.repo echo \"gpgcheck=1\" >>/etc/yum.repos.d/elasticsearch.repo echo \"gpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch\" >>/etc/yum.repos.d/elasticsearch.repo echo \"enabled=1\" >>/etc/yum.repos.d/elasticsearch.repo echo \"autorefresh=1\" >>/etc/yum.repos.d/elasticsearch.repo echo \"type=rpm-md\" >>/etc/yum.repos.d/elasticsearch.repo yum -y install elasticsearch /bin/systemctl daemon-reload /bin/systemctl enable elasticsearch.service systemctl start elasticsearch.service lampp restart echo \"===========SERVER DEPLOY SCRIPT============\" echo \"==domain : $domainname\" echo \"==user : $tusername\" echo \"==pass : $tpassword\" echo \"==pass root mysql: $spassword\" echo \"=========================================\"","title":"Install Server LAMPP on CentOS"},{"location":"install-server-lampp/#install-lampp","text":"yum update yum -y install install curl net-tools curl -o xampp-linux-installer.run \"https://downloadsapachefriends.global.ssl.fastly.net/xampp-files/7.1.29/xampp-linux-x64-7.1.29-0-installer.run?from_af=true\" sudo chmod +x xampp-linux-installer.run bash -c './xampp-linux-installer.run' Khi g\u1eb7p l\u1ed7i ti\u1ebfn tr\u00ecnh c\u00e0i \u0111\u1eb7t b\u1ecb killed n\u1eefa ch\u1eebng th\u00ec c\u00f3 th\u1ec3 l\u1ed7i l\u00e0 do ph\u00e2n v\u00f9ng swap kh\u00f4ng \u0111\u1ee7, th\u1ef1c hi\u1ec7n l\u1eb9nh sau \u0111\u1ec3 kh\u1eafc ph\u1ee5c. (copy tr\u00ean internet ch\u1ee9 ch\u01b0a tham kh\u1ea3o th\u00f4ng s\u1ed1 c\u1ee7a n\u00f3 ngh\u0129a l\u00e0 g\u00ec) sudo dd if=/dev/zero of=swapfile bs=1024 count=2000000 sudo mkswap -f swapfile sudo swapon swapfile","title":"Install LAMPP"},{"location":"install-server-lampp/#mo-port-804433306","text":"sudo iptables -I INPUT -p tcp -m tcp --dport 80 -j ACCEPT sudo iptables -I INPUT -p tcp -m tcp --dport 443 -j ACCEPT sudo iptables -I INPUT -p tcp -m tcp --dport 3306 -j ACCEPT","title":"M\u1edf port 80,443,3306"},{"location":"install-server-lampp/#thay-oi-user-va-group-cho-user-chay-lampp","text":"m\u1edf file /opt/lampp/etc/httpd.conf t\u00ecm d\u00f2ng sau v\u00e0 s\u1eeda l\u1ea1i th\u00e0nh user c\u1ee7a server n\u1ebfu c\u1ea7n thi\u1ebft User daemon Group daemon","title":"Thay \u0111\u1ed5i user v\u00e0 group cho user ch\u1ea1y lampp"},{"location":"install-server-lampp/#public-phpmyadmin","text":"S\u1eeda n\u1ed9i dung file /opt/lampp/etc/extra/httpd-xampp.conf, thay \u0111\u1ed5i require t\u1eeb local sang all granted n\u1ed9i dung ban \u0111\u1ea7u <Directory \"/opt/lampp/phpmyadmin\"> AllowOverride AuthConfig Limit Require local ErrorDocument 403 /error/XAMPP_FORBIDDEN.html.var </Directory> s\u1eeda th\u00e0nh <Directory \"/opt/lampp/phpmyadmin\"> AllowOverride AuthConfig Limit Require all granted ErrorDocument 403 /error/XAMPP_FORBIDDEN.html.var </Directory>","title":"Public phpmyadmin"},{"location":"install-server-lampp/#sua-oi-file-host-etchosts","text":"\u0110\u1ec3 cho ph\u00e9p truy c\u1eadp t\u1eeb ngo\u00e0i v\u00e0o server ch\u1ea1y xampp th\u00ec \u0111\u1ea7u ti\u00ean l\u00e0 c\u1ea7n tr\u1ecf t\u00ean mi\u1ec1n v\u1ec1 IP public c\u1ee7a server, \u0111\u1ebfn \u0111\u00e2y, server \u0111\u00e3 c\u00f3 th\u1ec3 truy c\u1eadp t\u1eeb b\u00ean ngo\u00e0i v\u00e0o r\u1ed3i. Vi\u1ec7c s\u1eeda \u0111\u1ed5i file hosts l\u00e0 1 trong c\u00e1c vi\u1ec7c ph\u1ea3i l\u00e0m n\u1ebfu mu\u1ed1n server ch\u1ea1y nhi\u1ec1u domain, c\u00f3 th\u1ec3 tham kh\u1ea3o b\u00e0i vi\u1ebft h\u01b0\u1edbng d\u1eabn t\u1ea1o domain cho server ch\u1ea1y xampp. 127.0.0.1 localhost 127.0.0.1 khanhtoan.name.vn","title":"S\u1eeda \u0111\u1ed5i file host /etc/hosts"},{"location":"install-server-lampp/#config-login-cho-phpmyadmin","text":"Thay \u0111\u1ed5i auth_type th\u00e0nh http trong file /opt/lampp/phpmyadmin/config.inc.php v\u00e0 comment 2 d\u00f2ng config username v\u00e0 password l\u1ea1i. $cfg['Servers'][$i]['auth_type'] = 'http';","title":"Config login cho phpmyadmin"},{"location":"install-server-lampp/#thay-oi-mat-khau-root-mysql","text":"mysql -u root -p USE mysql; UPDATE user SET password=PASSWORD('YourPasswordHere') WHERE User='root' AND Host = 'localhost'; FLUSH PRIVILEGES; \u0110\u1ed1i v\u1edbi LAMPP th\u00ec mysql n\u1eb1m \u1edf \u0111\u01b0\u1eddng d\u1eabn /opt/lampp/bin/mysql, do \u0111\u00f3 cmd s\u1ebd l\u00e0: /opt/lampp/bin/mysql -u=\"root\"","title":"Thay \u0111\u1ed5i m\u1eadt kh\u1ea9u root mysql"},{"location":"install-server-lampp/#them-vhosts-va-apache","text":"S\u1eeda file b\u1eb1ng c\u00f4ng c\u1ee5 vim, ch\u1ea1y l\u1ec7nh sau v\u00e0 \u1ea5n phim i \u0111\u1ec3 s\u1eeda, s\u1eeda xong b\u1ea5m ph\u00edm esc v\u00e0 g\u00f5 :wq sau \u0111\u00f3 enter \u0111\u1ec3 l\u01b0u file l\u1ea1i. vi /opt/lampp/etc/httpd.conf Th\u00eam v\u00e0o cu\u1ed1i file t\u00ean d\u00f2ng l\u1ec7nh sau: Include \"/opt/lampp/etc/extra/httpd-vhosts.conf\"","title":"Th\u00eam vhosts v\u00e0 apache"},{"location":"install-server-lampp/#cau-hinh-vhost","text":"M\u1edf file /opt/lampp/etc/extra/httpd-vhost.conf v\u00e0 add th\u00eam domain v\u00e0o, v\u00ed d\u1ee5 th\u00eam domain mautic.dotb.vn, c\u00f3 th\u01b0 m\u1ee5c root ch\u01b0a source l\u00e0 /opt/lampp/htdocs/mautic.dotb.vn <VirtualHost 127.0.0.1:80> DocumentRoot \"/opt/lampp/htdocs/mautic.dotb.vn\" ServerName mautic.dotb.vn ServerAlias www.mautic.dotb.vn </VirtualHost> Sau t\u1ea5t c\u1ea3 c\u00e1c c\u1ea5u h\u00ecnh, ti\u1ebfn h\u00e0nh restart l\u1ea1i lampp /opt/lampp/lampp restart","title":"C\u1ea5u h\u00ecnh vhost"},{"location":"install-server-lampp/#script","text":"#!/bin/bash #user if [ $(id -u) -eq 0 ]; then read -p \"Enter host Domain: \" domainname read -p \"Enter new Domain username: \" tusername egrep \"^$tusername\" /etc/passwd >/dev/null if [ $? -eq 0 ]; then echo \"$tusername exists!\" exit 1 else useradd $tusername passwd $tusername read -p \"Enter new password again (latest): \" tpassword fi else echo \"Only root may add a user to the system\" exit 2 fi read -p \"Enter new MySQL root password : \" spassword mkdir \"/home/$tusername/$domainname\" echo \"success! $domainname - $tusername\" >>/home/$tusername/$domainname/index.php chown -R $tusername:$tusername /home/$tusername echo \"127.0.0.1 $domainname\" >>/etc/hosts yum -y update #java yum -y install java-1.8.0-openjdk.x86_64 #lampp yum -y install curl net-tools curl -o lampp.run \"https://downloadsapachefriends.global.ssl.fastly.net/xampp-files/7.1.29/xampp-linux-x64-7.1.29-0-installer.run?from_af=true\" chmod +x lampp.run bash -c './lampp.run' ln -sf /opt/lampp/lampp /usr/bin/lampp ln -sf /opt/lampp/bin/mysql /usr/bin/mysql ln -sf /opt/lampp/bin/php /usr/bin/php lampp restart lampp stopftp #httpd and php sed -i.bak s'/Require local/Require all granted/g' /opt/lampp/etc/extra/httpd-xampp.conf sed -i \"s/'config'/'http'/g\" /opt/lampp/phpmyadmin/config.inc.php echo 'Include \"/opt/lampp/etc/extra/httpd-vhosts.conf\"' >>/opt/lampp/etc/httpd.conf sed -i \"s/User daemon/User $tusername/g\" /opt/lampp/etc/httpd.conf sed -i \"s/Group daemon/Group $tusername/g\" /opt/lampp/etc/httpd.conf sed -i \"s/\\/opt\\/lampp\\/htdocs/\\/home/g\" /opt/lampp/etc/httpd.conf sed -i \"s/webmaster@dummy-host.example.com/contact@dotb.vn/g\" /opt/lampp/etc/extra/httpd-vhosts.conf sed -i \"s/\\/opt\\/lampp\\/docs\\/dummy-host.example.com/\\/home\\/$tusername\\/$domainname/g\" /opt/lampp/etc/extra/httpd-vhosts.conf sed -i \"s/dummy-host.example.com/$domainname/g\" /opt/lampp/etc/extra/httpd-vhosts.conf rm -f /opt/lampp/etc/php.ini echo '[PHP] engine=On short_open_tag=Off short_open_tag=On asp_tags=Off precision=14 y2k_compliance=On output_buffering=4096 zlib.output_compression=Off implicit_flush=Off unserialize_callback_func= serialize_precision=100 allow_call_time_pass_reference=Off safe_mode=Off safe_mode_gid=Off safe_mode_include_dir= safe_mode_exec_dir= safe_mode_allowed_env_vars=PHP_ safe_mode_protected_env_vars=LD_LIBRARY_PATH disable_functions= disable_classes= expose_php=On max_execution_time=3600 max_input_time=3600 memory_limit=2048M error_reporting=E_ALL & ~E_DEPRECATED & ~E_STRICT display_errors=Off display_startup_errors=On log_errors=On log_errors_max_len=1024 ignore_repeated_errors=Off ignore_repeated_source=Off report_memleaks=On track_errors=On html_errors=On error_log=\"/opt/lampp/logs/php_error_log\" variables_order=\"GPCS\" request_order=\"GP\" register_globals=Off register_long_arrays=Off register_argc_argv=Off auto_globals_jit=On post_max_size=1280M magic_quotes_gpc=Off magic_quotes_runtime=Off magic_quotes_sybase=Off auto_prepend_file= auto_append_file= default_mimetype=\"text/html\" doc_root= user_dir= enable_dl=Off file_uploads=On upload_tmp_dir=\"/opt/lampp/temp/\" upload_max_filesize=1280M allow_url_fopen=On allow_url_include=Off default_socket_timeout=60 [Date] date.timezone=Asia/Ho_Chi_Minh [filter] [iconv] [intl] [sqlite] [sqlite3] [Pcre] [Pdo] [Pdo_mysql] pdo_mysql.cache_size=2000 pdo_mysql.default_socket= [Phar] [Syslog] define_syslog_variables=Off [mail function] SMTP=localhost smtp_port=25 mail.add_x_header=On [SQL] sql.safe_mode=Off [ODBC] odbc.allow_persistent=On odbc.check_persistent=On odbc.max_persistent=-1 odbc.max_links=-1 odbc.defaultlrl=4096 odbc.defaultbinmode=1 [Interbase] ibase.allow_persistent=1 ibase.max_persistent=-1 ibase.max_links=-1 ibase.timestampformat=\"%Y-%m-%d %H:%M:%S\" ibase.dateformat=\"%Y-%m-%d\" ibase.timeformat=\"%H:%M:%S\" [MySQL] mysql.allow_local_infile=On mysql.allow_persistent=On mysql.cache_size=2000 mysql.max_persistent=-1 mysql.max_links=-1 mysql.default_port= mysql.default_socket= mysql.default_host= mysql.default_user= mysql.default_password= mysql.connect_timeout=60 mysql.trace_mode=Off [MySQLi] mysqli.max_persistent=-1 mysqli.max_links=-1 mysqli.cache_size=2000 mysqli.default_port=3306 mysqli.default_socket= mysqli.default_host= mysqli.default_user= mysqli.default_pw= mysqli.reconnect=Off [mysqlnd] mysqlnd.collect_statistics=On mysqlnd.collect_memory_statistics=On [OCI8] [PostgresSQL] pgsql.allow_persistent=On pgsql.auto_reset_persistent=Off pgsql.max_persistent=-1 pgsql.max_links=-1 pgsql.ignore_notice=0 pgsql.log_notice=0 [Sybase-CT] sybct.allow_persistent=On sybct.max_persistent=-1 sybct.max_links=-1 sybct.min_server_severity=10 sybct.min_client_severity=10 [bcmath] bcmath.scale=0 [browscap] [Session] session.save_handler=files session.save_path=\"/opt/lampp/temp/\" session.use_cookies=1 session.use_only_cookies=1 session.name=PHPSESSID session.auto_start=0 session.cookie_lifetime=0 session.cookie_path=/ session.cookie_domain= session.cookie_httponly=1 session.serialize_handler=php session.gc_probability=1 session.gc_divisor=1000 session.gc_maxlifetime=1440 session.bug_compat_42=On session.bug_compat_warn=On session.referer_check= session.entropy_length=0 session.entropy_file= session.cache_limiter=nocache session.cache_expire=180 session.use_trans_sid=1 session.hash_function=0 session.hash_bits_per_character=5 url_rewriter.tags=\"a=href,area=href,frame=src,input=src,form=fakeentry\" [MSSQL] mssql.allow_persistent=On mssql.max_persistent=-1 mssql.max_links=-1 mssql.min_error_severity=10 mssql.min_message_severity=10 mssql.compatability_mode=Off mssql.secure_connection=Off [Assertion] [COM] [mbstring] [gd] [exif] [Tidy] tidy.clean_output=Off [soap] soap.wsdl_cache_enabled=1 soap.wsdl_cache_dir=\"/tmp\" soap.wsdl_cache_ttl=86400 soap.wsdl_cache_limit=5 [sysvshm] [ldap] ldap.max_links=-1 [mcrypt] [dba] openssl.cafile=/opt/lampp/share/curl/curl-ca-bundle.crt ' >>/opt/lampp/etc/php.ini #mysql echo \" use mysql; UPDATE user SET password=PASSWORD('$spassword') WHERE User='root'; FLUSH PRIVILEGES; GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY '$spassword'; FLUSH PRIVILEGES; \" >>/change_password_mysql.sql echo \">>press Enter to pass ask below<<\" mysql -u root -p mysql </change_password_mysql.sql rm -f /change_password_mysql.sql rm -f /opt/lampp/etc/my.cnf echo ' [client] port = 3306 socket = /opt/lampp/var/mysql/mysql.sock [mysqld] user = mysql port=3306 socket = /opt/lampp/var/mysql/mysql.sock skip-external-locking key_buffer = 160M max_allowed_packet = 10M table_open_cache = 64 sort_buffer_size = 5M net_buffer_length = 80K read_buffer_size = 2M read_rnd_buffer_size = 5M myisam_sort_buffer_size = 80M plugin_dir = /opt/lampp/lib/mysql/plugin/ server-id = 1 innodb_data_home_dir = /opt/lampp/var/mysql/ innodb_data_file_path = ibdata1:10M:autoextend innodb_log_group_home_dir = /opt/lampp/var/mysql/ innodb_buffer_pool_size = 160M innodb_log_file_size = 50M innodb_log_buffer_size = 80M innodb_flush_log_at_trx_commit = 1 innodb_lock_wait_timeout = 50 [mysqldump] quick max_allowed_packet = 160M [mysql] no-auto-rehash [isamchk] key_buffer = 200M sort_buffer_size = 200M read_buffer = 20M write_buffer = 20M [myisamchk] key_buffer = 200M sort_buffer_size = 200M read_buffer = 20M write_buffer = 20M [mysqlhotcopy] interactive-timeout !include /opt/lampp/mysql/my.cnf ' >>/opt/lampp/etc/my.cnf #elasticsearch rpm --import https://artifacts.elastic.co/GPG-KEY-elasticsearch echo \"[elasticsearch-6.x]\" >>/etc/yum.repos.d/elasticsearch.repo echo \"name=Elasticsearch repository for 6.x packages\" >>/etc/yum.repos.d/elasticsearch.repo echo \"baseurl=https://artifacts.elastic.co/packages/6.x/yum\" >>/etc/yum.repos.d/elasticsearch.repo echo \"gpgcheck=1\" >>/etc/yum.repos.d/elasticsearch.repo echo \"gpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch\" >>/etc/yum.repos.d/elasticsearch.repo echo \"enabled=1\" >>/etc/yum.repos.d/elasticsearch.repo echo \"autorefresh=1\" >>/etc/yum.repos.d/elasticsearch.repo echo \"type=rpm-md\" >>/etc/yum.repos.d/elasticsearch.repo yum -y install elasticsearch /bin/systemctl daemon-reload /bin/systemctl enable elasticsearch.service systemctl start elasticsearch.service lampp restart echo \"===========SERVER DEPLOY SCRIPT============\" echo \"==domain : $domainname\" echo \"==user : $tusername\" echo \"==pass : $tpassword\" echo \"==pass root mysql: $spassword\" echo \"=========================================\"","title":"Script"},{"location":"setup-ssl-let-encript/","text":"Install Let's Encrypt sudo yum -y install yum-utils sudo yum install https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm sudo yum-config-manager --enable rhui-REGION-rhel-server-extras rhui-REGION-rhel-server-optional sudo yum install certbot Create new SSL sudo certbot certonly --webroot -w /var/www/example -d example.com Renew SSL certbot renew","title":"Set up SSL Let's Encrypt"},{"location":"setup-ssl-let-encript/#install-lets-encrypt","text":"sudo yum -y install yum-utils sudo yum install https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm sudo yum-config-manager --enable rhui-REGION-rhel-server-extras rhui-REGION-rhel-server-optional sudo yum install certbot","title":"Install Let's Encrypt"},{"location":"setup-ssl-let-encript/#create-new-ssl","text":"sudo certbot certonly --webroot -w /var/www/example -d example.com","title":"Create new SSL"},{"location":"setup-ssl-let-encript/#renew-ssl","text":"certbot renew","title":"Renew SSL"}]}